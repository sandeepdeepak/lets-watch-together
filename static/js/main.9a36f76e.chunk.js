(this["webpackJsonpamazon-ivs-chime-demo-web-ui"]=this["webpackJsonpamazon-ivs-chime-demo-web-ui"]||[]).push([[0],{238:function(e,t,n){},327:function(e,t,n){},333:function(e,t,n){},334:function(e,t,n){},335:function(e,t,n){"use strict";n.r(t);var i=n(3),c=n.n(i),a=n(227),s=n.n(a),o=(n(238),n(40)),r=n(11),u="https://ssnbwkst29.execute-api.us-east-1.amazonaws.com/Prod/",l="wss://a15b7eqcnb.execute-api.us-east-1.amazonaws.com/Prod/",d=!1,h=n(10),v=n(228),b=n(229),p=n(4),m=n.n(p),j=n(16),f=n(230),O=n.n(f),g=function(){function e(){Object(v.a)(this,e),this.initializeSdkWrapper()}return Object(b.a)(e,[{key:"initializeSdkWrapper",value:function(){this.meetingSession=null,this.audioVideo=null,this.title=null,this.name=null,this.region=null,this.currentAudioInputDevice=null,this.currentAudioOutputDevice=null,this.currentVideoInputDevice=null,this.audioInputDevices=[],this.audioOutputDevices=[],this.videoInputDevices=[],this.devicesUpdatedCallbacks=[],this.roster={},this.rosterUpdateCallbacks=[],this.configuration=null,this.messagingSocket=null,this.messageUpdateCallbacks=[]}},{key:"logError",value:function(e){console.error(e)}},{key:"createRoom",value:function(){var e=Object(h.a)(m.a.mark((function e(t,n,i,c,a){var s,o,r,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&i&&t){e.next=3;break}return console.error("role=".concat(t," name=").concat(n," title=").concat(i," must exist")),e.abrupt("return");case 3:return s={name:n,title:i,playbackURL:c,role:t},e.next=6,fetch("".concat(u,"/join"),{method:"POST",body:JSON.stringify(s)});case 6:return o=e.sent,e.next=9,o.json();case 9:if(!(r=e.sent).error){e.next=12;break}throw new Error(r.error);case 12:if(l=r.JoinInfo){e.next=15;break}throw new Error("CreateOrJoin.classRoomDoesNotExist");case 15:return this.configuration=new j.MeetingSessionConfiguration(l.Meeting,l.Attendee),e.next=18,this.initializeMeetingSession(this.configuration);case 18:return this.title=i,this.name=n,this.region=a,e.abrupt("return",l);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n,i,c,a){return e.apply(this,arguments)}}()},{key:"reInitializeMeetingSession",value:function(){var e=Object(h.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.configuration=new j.MeetingSessionConfiguration(t.Meeting,t.Attendee),e.next=3,this.initializeMeetingSession(this.configuration);case 3:this.title=t.Title,this.name=n;case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"initializeMeetingSession",value:function(){var e=Object(h.a)(m.a.mark((function e(t){var n,i,c=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new j.ConsoleLogger("SDK",j.LogLevel.ERROR),i=new j.DefaultDeviceController(n),this.meetingSession=new j.DefaultMeetingSession(t,n,i),this.audioVideo=this.meetingSession.audioVideo,this.audioInputDevices=[],e.next=7,this.audioVideo.listAudioInputDevices();case 7:return e.sent.forEach((function(e){c.audioInputDevices.push({label:e.label,value:e.deviceId})})),this.audioOutputDevices=[],e.next=11,this.audioVideo.listAudioOutputDevices();case 11:return e.sent.forEach((function(e){c.audioOutputDevices.push({label:e.label,value:e.deviceId})})),this.videoInputDevices=[],e.next=15,this.audioVideo.listVideoInputDevices();case 15:e.sent.forEach((function(e){c.videoInputDevices.push({label:e.label,value:e.deviceId})})),this.publishDevicesUpdated(),this.audioVideo.addDeviceChangeObserver(this),this.audioVideo.realtimeSubscribeToAttendeeIdPresence((function(e,t){if(!t)return delete c.roster[e],void c.publishRosterUpdate()();c.audioVideo.realtimeSubscribeToVolumeIndicator(e,function(){var e=Object(h.a)(m.a.mark((function e(t,n,i,a){var s,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(new j.DefaultModality(t).base()===t){e.next=3;break}return e.abrupt("return");case 3:if(!1,c.roster[t]||(c.roster[t]={name:""}),null!==n&&(c.roster[t].volume=Math.round(100*n)),null!==i&&(c.roster[t].muted=i),null!==a&&(c.roster[t].signalStrength=Math.round(100*a)),!c.title||!t||c.roster[t].name){e.next=16;break}return e.next=11,fetch("".concat(u,"/attendee?title=").concat(encodeURIComponent(c.title),"&attendeeId=").concat(encodeURIComponent(t)));case 11:return s=e.sent,e.next=14,s.json();case 14:(o=e.sent).AttendeeInfo&&c.roster[t]&&(c.roster[t].name=o.AttendeeInfo.Name||"",!0);case 16:c.publishRosterUpdate()();case 18:case"end":return e.stop()}}),e)})));return function(t,n,i,c){return e.apply(this,arguments)}}())}));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"joinRoom",value:function(){var e=Object(h.a)(m.a.mark((function e(t){var n,i,c,a=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return this.logError(new Error("element does not exist")),e.abrupt("return");case 3:return window.addEventListener("unhandledrejection",(function(e){a.logError(e.reason)})),e.next=6,this.audioVideo.listAudioInputDevices();case 6:if(!((n=e.sent)&&n.length>0&&n[0].deviceId)){e.next=11;break}return this.currentAudioInputDevice={label:n[0].label,value:n[0].deviceId},e.next=11,this.audioVideo.chooseAudioInputDevice(n[0].deviceId);case 11:return e.next=13,this.audioVideo.listAudioOutputDevices();case 13:if(!((i=e.sent)&&i.length>0&&i[0].deviceId)){e.next=18;break}return this.currentAudioOutputDevice={label:i[0].label,value:i[0].deviceId},e.next=18,this.audioVideo.chooseAudioOutputDevice(i[0].deviceId);case 18:return e.next=20,this.audioVideo.listVideoInputDevices();case 20:if(!((c=e.sent)&&c.length>0&&c[0].deviceId)){e.next=25;break}return this.currentVideoInputDevice={label:c[0].label,value:c[0].deviceId},e.next=25,this.audioVideo.chooseVideoInputDevice(null);case 25:return this.publishDevicesUpdated(),e.prev=26,e.next=29,this.audioVideo.bindAudioElement(t);case 29:this.audioVideo.start(),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(26),console.log("failed to bind audio element: ",e.t0);case 35:case"end":return e.stop()}}),e,this,[[26,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"joinRoomMessaging",value:function(){var e=Object(h.a)(m.a.mark((function e(){var t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.configuration){e.next=3;break}return this.logError(new Error("configuration does not exist")),e.abrupt("return");case 3:return t="".concat(l,"?MeetingId=").concat(this.configuration.meetingId,"&AttendeeId=").concat(this.configuration.credentials.attendeeId,"&JoinToken=").concat(this.configuration.credentials.joinToken),this.messagingSocket=new j.ReconnectingPromisedWebSocket(t,[],"arraybuffer",new j.DefaultPromisedWebSocketFactory(new j.DefaultDOMWebSocketFactory),new j.FullJitterBackoff(1e3,0,1e4)),e.next=7,this.messagingSocket.open(this.WEB_SOCKET_TIMEOUT_MS);case 7:this.messagingSocket.addEventListener("message",(function(e){try{var t,i=JSON.parse(e.data),c=i.payload.attendeeId;n.roster[c]&&(t=n.roster[c].name),n.publishMessageUpdate({type:i.type,payload:i.payload,timestampMs:Date.now(),name:t})}catch(a){n.logError(a)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendMessage",value:function(e,t){if(this.messagingSocket){var n={message:"sendmessage",data:JSON.stringify({type:e,payload:t})};try{this.messagingSocket.send(JSON.stringify(n))}catch(i){this.logError(i)}}}},{key:"leaveRoom",value:function(){var e=Object(h.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.audioVideo.stop()}catch(n){this.logError(n)}if(e.prev=1,!t||!this.title){e.next=5;break}return e.next=5,fetch("".concat(u,"/end?title=").concat(encodeURIComponent(this.title)),{method:"POST"});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),this.logError(e.t0);case 10:this.initializeSdkWrapper();case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"chooseAudioInputDevice",value:function(){var e=Object(h.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.audioVideo.chooseAudioInputDevice(t.value);case 3:this.currentAudioInputDevice=t,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.logError(e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"chooseAudioOutputDevice",value:function(){var e=Object(h.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.audioVideo.chooseAudioOutputDevice(t.value);case 3:this.currentAudioOutputDevice=t,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.logError(e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"chooseVideoInputDevice",value:function(){var e=Object(h.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.audioVideo.chooseVideoInputDevice(t.value);case 3:this.currentVideoInputDevice=t,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.logError(e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"audioInputsChanged",value:function(e){var t=this,n=!1;this.audioInputDevices=[],e.forEach((function(e){t.currentAudioInputDevice&&e.deviceId===t.currentAudioInputDevice.value&&(n=!0),t.audioInputDevices.push({label:e.label,value:e.deviceId})})),n||(this.currentAudioInputDevice=this.audioInputDevices.length>0?this.audioInputDevices[0]:null),this.publishDevicesUpdated()}},{key:"audioOutputsChanged",value:function(e){var t=this,n=!1;this.audioOutputDevices=[],e.forEach((function(e){t.currentAudioOutputDevice&&e.deviceId===t.currentAudioOutputDevice.value&&(n=!0),t.audioOutputDevices.push({label:e.label,value:e.deviceId})})),n||(this.currentAudioOutputDevice=this.audioOutputDevices.length>0?this.audioOutputDevices[0]:null),this.publishDevicesUpdated()}},{key:"videoInputsChanged",value:function(e){var t=this,n=!1;this.videoInputDevices=[],e.forEach((function(e){t.currentVideoInputDevice&&e.deviceId===t.currentVideoInputDevice.value&&(n=!0),t.videoInputDevices.push({label:e.label,value:e.deviceId})})),n||(this.currentVideoInputDevice=this.videoInputDevices.length>0?this.videoInputDevices[0]:null),this.publishDevicesUpdated()}},{key:"subscribeToDevicesUpdated",value:function(e){this.devicesUpdatedCallbacks.push(e)}},{key:"unsubscribeFromDevicesUpdated",value:function(e){var t=this.devicesUpdatedCallbacks.indexOf(e);-1!==t&&this.devicesUpdatedCallbacks.splice(t,1)}},{key:"publishDevicesUpdated",value:function(){var e=this;this.devicesUpdatedCallbacks.forEach((function(t){t({currentAudioInputDevice:e.currentAudioInputDevice,currentAudioOutputDevice:e.currentAudioOutputDevice,currentVideoInputDevice:e.currentVideoInputDevice,audioInputDevices:e.audioInputDevices,audioOutputDevices:e.audioOutputDevices,videoInputDevices:e.videoInputDevices})}))}},{key:"subscribeToRosterUpdate",value:function(e){this.rosterUpdateCallbacks.push(e)}},{key:"unsubscribeFromRosterUpdate",value:function(e){var t=this.rosterUpdateCallbacks.indexOf(e);-1!==t&&this.rosterUpdateCallbacks.splice(t,1)}},{key:"publishRosterUpdate",value:function(){var e=this;return O()((function(){for(var t=0;t<e.rosterUpdateCallbacks.length;t+=1){(0,e.rosterUpdateCallbacks[t])(e.roster)}}),this.ROSTER_THROTTLE_MS)}},{key:"subscribeToMessageUpdate",value:function(e){this.messageUpdateCallbacks.push(e)}},{key:"unsubscribeFromMessageUpdate",value:function(e){var t=this.messageUpdateCallbacks.indexOf(e);-1!==t&&this.messageUpdateCallbacks.splice(t,1)}},{key:"publishMessageUpdate",value:function(e){for(var t=0;t<this.messageUpdateCallbacks.length;t+=1){(0,this.messageUpdateCallbacks[t])(e)}}}]),e}();g.WEB_SOCKET_TIMEOUT_MS=1e4,g.ROSTER_THROTTLE_MS=400;var x=n(8),w=(n(327),n(2)),C=function(e){Object(i.useEffect)((function(){return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}));var t=function(t){27===t.keyCode&&e.closeError()};return Object(w.jsx)("div",{className:"notice notice--error",onClick:function(t){for(var n=t.target,i=!1;n;){if(n&&n.classList&&n.classList.contains("notice--error")){i=!0;break}n=n.parentNode}i||e.closeError()},children:Object(w.jsxs)("div",{className:"notice__content",children:[Object(w.jsx)("div",{className:"icon icon--24 notice__icon",children:Object(w.jsx)("svg",{viewBox:"0 0 1000 1000",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M 500 0C 224 0 0 224 0 500C 0 776 224 1000 500 1000C 776 1000 1000 776 1000 500C 1000 224 776 0 500 0C 500 0 500 0 500 0M 526 150C 576 150 602 175 601 224C 600 300 600 350 575 525C 570 560 560 575 525 575C 525 575 475 575 475 575C 440 575 430 560 425 525C 400 355 400 300 400 226C 400 175 425 150 475 150M 500 650C 527 650 552 661 571 679C 589 698 600 723 600 750C 600 805 555 850 500 850C 445 850 400 805 400 750C 400 723 411 698 429 679C 448 661 473 650 500 650C 500 650 500 650 500 650"})})}),e.errorMsg,Object(w.jsxs)("div",{children:["To create your own room, click"," ",Object(w.jsx)("span",{className:"go-create-room",onClick:function(){window.location.replace("/index.html")},children:"here"}),"."]})]})})},y=Object(r.f)((function(e){var t=e.location,n=e.history,a=Object(i.useState)(""),s=Object(x.a)(a,2),o=s[0],r=s[1],u=Object(i.useState)(""),l=Object(x.a)(u,2),d=l[0],v=l[1],b=Object(i.useState)("https://fcc3ddae59ed.us-west-2.playback.live-video.net/api/video/v1/us-west-2.893648527354.channel.DmumNckWFTqz.m3u8"),p=Object(x.a)(b,2),j=p[0],f=p[1],O=Object(i.useState)(""),g=Object(x.a)(O,2),y=g[0],I=g[1],_=Object(i.useState)(!1),k=Object(x.a)(_,2),D=k[0],L=k[1],S=Object(i.createRef)();Object(i.useEffect)((function(){var e=new URLSearchParams(t.search);if("join"===e.get("action")){var i=e.get("room");n.push("".concat("","/join?room=").concat(i))}S.current.focus()}),[]);var V=function(e){I(e),L(!0)},N=function(){var e=Object(h.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={username:o,title:d,playbackURL:j,role:"host"},sessionStorage.setItem("chime[".concat(d,"]"),JSON.stringify(t)),n.push("".concat("","/meeting?room=").concat(d));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=!o||!d||!j;return Object(w.jsxs)(c.a.Fragment,{children:[Object(w.jsxs)("div",{className:"welcome form-grid",children:[Object(w.jsx)("div",{className:"welcome__intro",children:Object(w.jsxs)("div",{className:"intro__inner formatted-text",children:[Object(w.jsx)("h1",{children:"Amazon IVS with ChimeSDK"}),Object(w.jsx)("h3",{children:"Create or join rooms, and watch Amazon IVS streams with anyone."})]})}),Object(w.jsx)("div",{className:"welcome__content pd-4",children:Object(w.jsxs)("div",{className:"content__inner",children:[Object(w.jsx)("h2",{className:"mg-b-2",children:"Get started"}),Object(w.jsx)("form",{action:"",children:Object(w.jsxs)("fieldset",{className:"mg-b-2",children:[Object(w.jsx)("input",{className:"mg-b-2",type:"text",placeholder:"Your name",value:o,ref:S,onChange:function(e){r(e.target.value)}}),Object(w.jsx)("input",{type:"text",placeholder:"Room name",value:d,onChange:function(e){v(e.target.value)}}),Object(w.jsx)("input",{type:"text",placeholder:"Playback URL",value:j,onChange:function(e){f(e.target.value)}}),Object(w.jsx)("button",{className:"mg-t-2 btn btn--primary",disabled:E,onClick:function(e){e.preventDefault(),e.stopPropagation();try{N()}catch(t){V(y)}},children:"Create room"})]})})]})})]}),D&&Object(w.jsx)(C,{closeError:function(){return D(!1)},errorMsg:y})]})})),I=Object(r.f)((function(e){var t=Object(i.useState)(""),n=Object(x.a)(t,2),c=n[0],a=n[1],s=Object(i.useState)(""),o=Object(x.a)(s,2),r=o[0],u=o[1],l=Object(i.useState)(""),d=Object(x.a)(l,2),v=d[0],b=d[1],p=Object(i.useState)(!1),j=Object(x.a)(p,2),f=j[0],O=j[1],g=Object(i.createRef)();Object(i.useEffect)((function(){var t=new URLSearchParams(e.location.search).get("room");u(t)}));var y=function(){var t=Object(h.a)(m.a.mark((function t(){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n={username:c,title:r,role:"attendee"},sessionStorage.setItem("chime[".concat(r,"]"),JSON.stringify(n)),e.history.push("".concat("","/meeting?room=").concat(r));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),I=function(){b("Something went wrong"),O(!1)},_=!c;return Object(w.jsxs)("div",{className:"welcome form-grid",onClick:function(e){for(var t=e.target,n=!1;t;){if(t&&t.classList&&t.classList.contains("notice--error")){n=!0;break}t=t.parentNode}n||I()},children:[Object(w.jsx)("div",{className:"welcome__intro",children:Object(w.jsxs)("div",{className:"intro__inner formatted-text",children:[Object(w.jsx)("h1",{children:"Amazon IVS with ChimeSDK"}),Object(w.jsx)("h3",{children:"Create or join rooms, and watch Amazon IVS streams with anyone."})]})}),Object(w.jsx)("div",{className:"welcome__content pd-4",children:Object(w.jsxs)("div",{className:"content__inner",children:[Object(w.jsx)("h2",{className:"mg-b-2",children:"Hey there!"}),Object(w.jsx)("form",{action:"",children:Object(w.jsxs)("fieldset",{className:"mg-b-2",children:[Object(w.jsx)("input",{type:"text",placeholder:"Your name",value:c,ref:g,onChange:function(e){a(e.target.value)}}),Object(w.jsx)("button",{className:"mg-t-1 btn btn--primary",disabled:_,onClick:function(e){e.preventDefault(),e.stopPropagation(),y()},children:"Join room"})]})})]})}),f&&Object(w.jsx)(C,{closeError:I,errorMsg:v})]})})),_=n(31),k=function(e){var t=Object(i.createRef)();Object(i.useEffect)((function(){var e=document.createElement("script");e.src="https://player.live-video.net/1.8.0/amazon-ivs-player.min.js",e.async=!0,e.onload=function(){return n()},document.body.appendChild(e)}),[]);var n=function(){var t=window.IVSPlayer,n=document.getElementById("overlay"),i=document.getElementById("play"),c=document.getElementById("mute");if(t.isPlayerSupported){var a=t.PlayerState,s=t.PlayerEventType,o=t.create();o.attachHTMLVideoElement(document.getElementById("video-player")),o.addEventListener(a.PLAYING,(function(){d})),o.addEventListener(a.ENDED,(function(){d})),o.addEventListener(a.READY,(function(){d})),o.addEventListener(s.ERROR,(function(e){d})),o.addEventListener(s.TEXT_METADATA_CUE,(function(e){e.text,o.getPosition().toFixed(2)})),o.setAutoplay(!0),o.load(e.videoStream),o.setVolume(.1),n.addEventListener("mouseover",(function(e){n.classList.add("overlay--hover")}),!1),n.addEventListener("mouseout",(function(e){n.classList.remove("overlay--hover")})),i.addEventListener("click",(function(e){i.classList.contains("player-btn--play")?(i.classList.remove("player-btn--play"),i.classList.add("player-btn--pause"),o.pause()):(i.classList.remove("player-btn--pause"),i.classList.add("player-btn--play"),o.play())}),!1),c.addEventListener("click",(function(e){c.classList.contains("player-btn--mute")?(c.classList.remove("player-btn--mute"),c.classList.add("player-btn--unmute"),o.setMuted(1)):(c.classList.remove("player-btn--unmute"),c.classList.add("player-btn--mute"),o.setMuted(0))}),!1)}else console.warn("The current browser does not support the Amazon IVS player.")};return Object(w.jsxs)("div",{className:"player-wrapper pos-relative",children:[Object(w.jsx)("div",{className:"aspect-spacer"}),Object(w.jsxs)("div",{className:"pos-absolute full-width full-height top-0",children:[Object(w.jsx)("div",{id:"overlay",className:"overlay",children:Object(w.jsx)("div",{id:"player-controls",children:Object(w.jsxs)("div",{className:"player-controls__inner",children:[Object(w.jsxs)("button",{id:"play",className:"mg-x-1 player-btn player-btn--icon player-btn--play",children:[Object(w.jsx)("svg",{className:"player-icon player-icon--play",xmlns:"http://www.w3.org/2000/svg",height:"36",viewBox:"0 0 24 24",width:"36",children:Object(w.jsx)("path",{d:"M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82z"})}),Object(w.jsx)("svg",{className:"player-icon player-icon--pause",xmlns:"http://www.w3.org/2000/svg",height:"36",viewBox:"0 0 24 24",width:"36",children:Object(w.jsx)("path",{d:"M8 19c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2v10c0 1.1.9 2 2 2zm6-12v10c0 1.1.9 2 2 2s2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2z"})})]}),Object(w.jsxs)("button",{id:"mute",className:"mg-x-1 player-btn player-btn--icon player-btn--unmute",children:[Object(w.jsx)("svg",{className:"player-icon player-icon--volume_up",xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24",children:Object(w.jsx)("path",{d:"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z"})}),Object(w.jsx)("svg",{className:"player-icon player-icon--volume_off",xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24",children:Object(w.jsx)("path",{d:"M3.63 3.63c-.39.39-.39 1.02 0 1.41L7.29 8.7 7 9H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71v-4.17l4.18 4.18c-.49.37-1.02.68-1.6.91-.36.15-.58.53-.58.92 0 .72.73 1.18 1.39.91.8-.33 1.55-.77 2.22-1.31l1.34 1.34c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-3.83-2.4-7.11-5.78-8.4-.59-.23-1.22.23-1.22.86v.19c0 .38.25.71.61.85C17.18 6.54 19 9.06 19 12zm-8.71-6.29l-.17.17L12 7.76V6.41c0-.89-1.08-1.33-1.71-.7zM16.5 12c0-1.77-1.02-3.29-2.5-4.03v1.79l2.48 2.48c.01-.08.02-.16.02-.24z"})})]})]})})}),Object(w.jsx)("video",{id:"video-player",className:"el-player",ref:t,playsInline:!0,muted:!0})]})]})},D=n(233),L=(n(333),function(e){var t=Object(i.useState)(""),n=Object(x.a)(t,2),c=n[0],a=n[1],s=Object(i.useState)([]),o=Object(x.a)(s,2),r=o[0],u=o[1],v=Object(i.useState)(null),b=Object(x.a)(v,2),p=b[0],j=b[1],f=Object(i.useState)(!1),O=Object(x.a)(f,2),g=O[0],C=O[1],y=Object(i.createRef)(),I=Object(i.createRef)();Object(i.useEffect)((function(){var t=function(){var t=Object(h.a)(m.a.mark((function t(){var n,i,c,a,s;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.joinInfo,i=n.Meeting,c=n.Attendee,a="".concat(l,"?MeetingId=").concat(i.MeetingId,"&AttendeeId=").concat(c.AttendeeId,"&JoinToken=").concat(c.JoinToken),t.next=4,new WebSocket(a);case 4:return(s=t.sent).onopen=function(e){console.log("websocket is now open",e)},s.addEventListener("message",(function(e){var t=e.data.split("::"),n=t[0],i=t.slice(1).join("::");u((function(e){return[].concat(Object(D.a)(e),[{timestamp:Date.now(),username:n,message:i}])}))})),j(s),t.abrupt("return",(function(){s.removeEventListener("message",(function(){console.log("Message event cancelled")}))}));case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[]),Object(i.useEffect)((function(){I.current.scrollIntoView({behavior:"smooth"})}));var _=function(e){navigator.clipboard&&navigator.clipboard.writeText(e).then((function(){C(!0),setTimeout((function(){C(!1)}),2e3)}),(function(e){d}))},k=g?"show":"";return Object(w.jsxs)("div",{className:"chat full-height pos-relative",children:[Object(w.jsx)("div",{className:"chat__room-link full-width",children:Object(w.jsxs)("button",{className:"room-link popup",onClick:function(t){t.stopPropagation(),t.preventDefault();var n=e.title,i="".concat(window.location.origin).concat(window.location.pathname.replace("meeting","index.html"),"?action=join&room=").concat(n);_(encodeURI(i))},children:[Object(w.jsx)("span",{className:"room-link__label",children:e.title}),Object(w.jsx)("svg",{className:"room-link__svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M3.25033 9.99999C3.25033 8.57499 4.40866 7.41666 5.83366 7.41666H9.16699V5.83333H5.83366C3.53366 5.83333 1.66699 7.69999 1.66699 9.99999C1.66699 12.3 3.53366 14.1667 5.83366 14.1667H9.16699V12.5833H5.83366C4.40866 12.5833 3.25033 11.425 3.25033 9.99999ZM6.66699 10.8333H13.3337V9.16666H6.66699V10.8333ZM14.167 5.83333H10.8337V7.41666H14.167C15.592 7.41666 16.7503 8.57499 16.7503 9.99999C16.7503 11.425 15.592 12.5833 14.167 12.5833H10.8337V14.1667H14.167C16.467 14.1667 18.3337 12.3 18.3337 9.99999C18.3337 7.69999 16.467 5.83333 14.167 5.83333Z",fill:"white"})}),Object(w.jsx)("span",{className:"popuptext ".concat(k),id:"myPopup",children:"Room link copied to clipboard"})]})}),Object(w.jsx)("div",{className:"chat__wrapper full-width pos-relative",children:Object(w.jsxs)("div",{className:"messages pd-x-1 pos-absolute",children:[r.map((function(e){var t=e.message.replace(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_.~#?&//=]*)/g,(function(e){var t=e;return e.startsWith("http")||(t="http://".concat(e)),"<a href=".concat(t,' class="chat-line__link" target="_blank" rel="noopener noreferrer">').concat(e,"</a>")}));return Object(w.jsx)("div",{className:"chat-line",children:Object(w.jsxs)("p",{children:[Object(w.jsx)("span",{className:"username",children:e.username}),Object(w.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})]})},e.timestamp)})),Object(w.jsx)("div",{ref:I})]})}),Object(w.jsx)("div",{className:"composer chime-web-composer full-width",children:Object(w.jsx)("input",{ref:y,type:"text",placeholder:"Say something",value:c,maxLength:510,onChange:function(e){a(e.target.value)},onKeyDown:function(t){if(13===t.keyCode){var n=e.username;if(c){var i='{\n          "message": "sendmessage",\n          "data": "'.concat(n,"::").concat(c.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),'"\n        }');p.send(i),a("")}}}})})]})}),S=function(e){var t=Object(i.useState)(!1),n=Object(x.a)(t,2),c=n[0],a=n[1],s=Object(i.useState)("Disabled"),o=Object(x.a)(s,2),r=o[0],u=o[1],l=Object(i.useState)(!1),d=Object(x.a)(l,2),v=d[0],b=d[1],p=function(e){a(e)};Object(i.useEffect)((function(){return e.chime.audioVideo.realtimeSubscribeToMuteAndUnmuteLocalAudio(p),function(){e&&e.chime.audioVideo&&e.chime.audioVideo.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(p)}}),[]);var j=function(){var t=Object(h.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c?e.chime.audioVideo.realtimeUnmuteLocalAudio():e.chime.audioVideo.realtimeMuteLocalAudio(),t.next=3,new Promise((function(e){return setTimeout(e,10)}));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),f=function(){var t=Object(h.a)(m.a.mark((function t(){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(e){return setTimeout(e,10)}));case 2:if("Disabled"!==r){t.next=29;break}if(u("Loading"),t.prev=4,e.chime.currentVideoInputDevice){t.next=7;break}throw new Error("currentVideoInputDevice does not exist");case 7:return t.prev=7,t.next=10,e.chime.chooseVideoInputDevice(e.chime.currentVideoInputDevice);case 10:t.next=19;break;case 12:return t.prev=12,t.t0=t.catch(7),t.next=16,e.chime.audioVideo.listVideoInputDevices();case 16:return n=t.sent,t.next=19,e.chime.audioVideo.chooseVideoInputDevice(n[0].deviceId);case 19:e.chime.audioVideo.startLocalVideoTile(),u("Enabled"),t.next=27;break;case 23:t.prev=23,t.t1=t.catch(4),console.error(t.t1),u("Disabled");case 27:t.next=30;break;case 29:"Enabled"===r&&(u("Loading"),e.chime.meetingSession.audioVideo.stopLocalVideoTile(),u("Disabled"));case 30:case"end":return t.stop()}}),t,null,[[4,23],[7,12]])})));return function(){return t.apply(this,arguments)}}(),O=function(){var t=Object(h.a)(m.a.mark((function t(){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b(!0),t.next=3,e.chime.leaveRoom("host"===e.role);case 3:sessionStorage.removeItem(e.ssName),n="".concat(e.baseHref,"/").concat("host"===e.role?"":"join?room="+e.title),e.history.push(n),b(!1);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),g=c?"controls__btn--mic_on":"controls__btn--mic_off",C="Enabled"===r?"controls__btn--cam_off":"controls__btn--cam_on";return Object(w.jsxs)("div",{className:"controls pos-relative",children:[Object(w.jsxs)("button",{className:"controls__btn ".concat(g," btn rounded btn--mic"),onClick:j,children:[Object(w.jsx)("svg",{className:"btn__svg btn__svg--mic_on",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M12 14C13.66 14 14.99 12.66 14.99 11L15 5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14ZM17.3 11C17.3 14 14.76 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C16.28 17.24 19 14.42 19 11H17.3Z",fill:"white"})}),Object(w.jsx)("svg",{className:"btn__svg btn__svg--mic_off",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z",fill:"white"})})]}),Object(w.jsxs)("button",{className:"controls__btn ".concat(C," btn rounded btn--cam"),onClick:f,children:[Object(w.jsx)("svg",{className:"btn__svg btn__svg--cam_on",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M17 10.5V7C17 6.45 16.55 6 16 6H4C3.45 6 3 6.45 3 7V17C3 17.55 3.45 18 4 18H16C16.55 18 17 17.55 17 17V13.5L21 17.5V6.5L17 10.5Z",fill:"white"})}),Object(w.jsx)("svg",{className:"btn__svg btn__svg--cam_off",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M21 6.5L17 10.5V7C17 6.45 16.55 6 16 6H9.82L21 17.18V6.5ZM3.27 2L2 3.27L4.73 6H4C3.45 6 3 6.45 3 7V17C3 17.55 3.45 18 4 18H16C16.21 18 16.39 17.92 16.54 17.82L19.73 21L21 19.73L3.27 2Z",fill:"white"})})]}),Object(w.jsx)("button",{className:"controls__btn btn rounded btn--settings",onClick:e.openSettings,children:Object(w.jsx)("svg",{className:"btn__svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M19.1401 12.936C19.1761 12.636 19.2001 12.324 19.2001 12C19.2001 11.676 19.1761 11.364 19.1281 11.064L21.1561 9.48002C21.3361 9.33602 21.3841 9.07202 21.2761 8.86802L19.3561 5.54402C19.2361 5.32802 18.9841 5.25602 18.7681 5.32802L16.3801 6.28802C15.8761 5.90402 15.3481 5.59202 14.7601 5.35202L14.4001 2.80802C14.3641 2.56802 14.1601 2.40002 13.9201 2.40002H10.0801C9.84011 2.40002 9.64811 2.56802 9.61211 2.80802L9.25211 5.35202C8.66411 5.59202 8.12411 5.91602 7.63211 6.28802L5.24411 5.32802C5.02811 5.24402 4.77611 5.32802 4.65611 5.54402L2.73611 8.86802C2.61611 9.08402 2.66411 9.33602 2.85611 9.48002L4.88411 11.064C4.83611 11.364 4.80011 11.688 4.80011 12C4.80011 12.312 4.82411 12.636 4.87211 12.936L2.84411 14.52C2.66411 14.664 2.61611 14.928 2.72411 15.132L4.64411 18.456C4.76411 18.672 5.01611 18.744 5.23211 18.672L7.62011 17.712C8.12411 18.096 8.65211 18.408 9.24011 18.648L9.60011 21.192C9.64811 21.432 9.84011 21.6 10.0801 21.6H13.9201C14.1601 21.6 14.3641 21.432 14.3881 21.192L14.7481 18.648C15.3361 18.408 15.8761 18.084 16.3681 17.712L18.7561 18.672C18.9721 18.756 19.2241 18.672 19.3441 18.456L21.2641 15.132C21.3841 14.916 21.3361 14.664 21.1441 14.52L19.1401 12.936ZM12.0001 15.6C10.0201 15.6 8.40011 13.98 8.40011 12C8.40011 10.02 10.0201 8.40002 12.0001 8.40002C13.9801 8.40002 15.6001 10.02 15.6001 12C15.6001 13.98 13.9801 15.6 12.0001 15.6Z"})})}),Object(w.jsx)("button",{className:"controls__btn btn rounded btn--leave btn--destruct",onClick:O,children:v?Object(w.jsx)("div",{className:"spinner"}):Object(w.jsx)("svg",{className:"btn__svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M12 9C10.4 9 8.85 9.25 7.4 9.72V12.82C7.4 13.21 7.17 13.56 6.84 13.72C5.86 14.21 4.97 14.84 4.18 15.57C4 15.75 3.75 15.85 3.48 15.85C3.2 15.85 2.95 15.74 2.77 15.56L0.29 13.08C0.11 12.91 0 12.66 0 12.38C0 12.1 0.11 11.85 0.29 11.67C3.34 8.78 7.46 7 12 7C16.54 7 20.66 8.78 23.71 11.67C23.89 11.85 24 12.1 24 12.38C24 12.66 23.89 12.91 23.71 13.09L21.23 15.57C21.05 15.75 20.8 15.86 20.52 15.86C20.25 15.86 20 15.75 19.82 15.58C19.03 14.84 18.13 14.22 17.15 13.73C16.82 13.57 16.59 13.23 16.59 12.83V9.73C15.15 9.25 13.6 9 12 9Z"})})})]})},V=function(e){var t=e.chime,n=e.closeSettings,c=e.saveSettings,a=e.joinInfo,s=Object(i.useState)(""),o=Object(x.a)(s,2),r=o[0],u=o[1],l=Object(i.useState)(""),v=Object(x.a)(l,2),b=v[0],p=v[1],j=Object(i.useState)(""),f=Object(x.a)(j,2),O=f[0],g=f[1],C=function(e){d};Object(i.useEffect)((function(){return document.addEventListener("keydown",y),t.subscribeToDevicesUpdated(C),function(){document.removeEventListener("keydown",y),t.unsubscribeFromDevicesUpdated(C)}}));var y=function(e){27===e.keyCode&&n()},I=function(){var e=Object(h.a)(m.a.mark((function e(n){var i,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g(n.target.value),!t.videoInputDevices.length){e.next=11;break}e.t0=m.a.keys(t.videoInputDevices);case 3:if((e.t1=e.t0()).done){e.next=10;break}if(c=e.t1.value,t.videoInputDevices[c].value!==n.target.value){e.next=8;break}return i=t.videoInputDevices[c],e.abrupt("break",10);case 8:e.next=3;break;case 10:t.chooseVideoInputDevice(i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e,t,n){return e&&e.length?e.map((function(e){return Object(w.jsx)("option",{value:e.value,children:"".concat(e.label)},e.value)})):Object(w.jsx)("option",{value:"no-permission",children:"Permission not granted to access ".concat(n," devices")})},k=t.currentAudioInputDevice,D=t.currentAudioOutputDevice,L=t.currentVideoInputDevice,S=t.audioInputDevices,V=t.audioOutputDevices,N=t.videoInputDevices;return Object(w.jsxs)("div",{className:"modal pos-absolute top-0 bottom-0 ",children:[Object(w.jsxs)("div",{className:"modal__el",children:[Object(w.jsx)("h1",{className:"mg-b-2",children:"Settings"}),Object(w.jsx)("form",{children:Object(w.jsxs)("fieldset",{children:[Object(w.jsx)("input",{className:"mg-b-2",name:"",id:"",type:"text",readOnly:!0,placeholder:"Playback URL",value:a.PlaybackURL,disabled:!0}),Object(w.jsx)("select",{name:"microphone",className:"select__field",onChange:function(e){if(u(e.target.value),t.audioInputDevices.length){var n,i;for(i in t.audioInputDevices)if(t.audioInputDevices[i].value===e.target.value){n=t.audioInputDevices[i];break}t.chooseAudioInputDevice(n)}},value:r||k.value,disabled:!S.length,children:_(S,0,"microphone")}),Object(w.jsx)("select",{name:"speaker",className:"select__field",onChange:function(e){if(p(e.target.value),t.audioOutputDevices.length){var n,i;for(i in t.audioOutputDevices)if(t.audioOutputDevices[i].value===e.target.value){n=t.audioOutputDevices[i];break}t.chooseAudioOutputDevice(n)}},value:b||(null===D||void 0===D?void 0:D.value),disabled:!V.length,children:_(V,0,"speaker")}),Object(w.jsx)("select",{name:"camera",className:"select__field",onChange:I,value:O||L.value,disabled:!N.length,children:_(N,0,"camera")}),Object(w.jsx)("button",{className:"btn btn--primary mg-t-2",onClick:function(e){e.stopPropagation(),e.preventDefault(),c(r,b,O)},children:"Save"})]})})]}),Object(w.jsx)("div",{className:"modal__overlay"})]})},N=function(e){var t=Object(i.useState)(!1),n=Object(x.a)(t,2),c=n[0],a=n[1],s=Object(i.useState)(!1),o=Object(x.a)(s,2),r=o[0],u=o[1],l=Object(i.useState)(!0),d=Object(x.a)(l,2),h=d[0],v=d[1],b=Object(i.createRef)(),p=function(t){var n;for(n in t)n===e.joinInfo.Attendee.AttendeeId&&u(t[n].muted)};Object(i.useEffect)((function(){return setTimeout((function(){v(!1)}),2500),e.chime.audioVideo.addObserver({videoTileDidUpdate:function(t){t.boundAttendeeId&&t.localTile&&t.tileId&&b.current&&(e.chime.audioVideo.bindVideoElement(t.tileId,b.current),a(t.active))}}),e.chime.subscribeToRosterUpdate(p),function(){e.chime.unsubscribeFromRosterUpdate(p)}}));var m=r?"controls__btn--mic_on":"controls__btn--mic_off",j=h||r||!c?"":" cam__meta--hide";return Object(w.jsxs)("div",{className:"cam",onMouseEnter:function(){return v(!0)},onMouseLeave:function(){return v(!1)},children:[Object(w.jsx)("div",{className:"cam__preview",children:Object(w.jsx)("div",{className:"video-container pos-relative",children:Object(w.jsx)("video",{className:"attendee_cam",ref:b})})}),Object(w.jsxs)("span",{className:"cam__meta".concat(j),id:"".concat(e.joinInfo.Attendee.AttendeeId),children:["You",Object(w.jsxs)("span",{className:"".concat(m," btn--mic"),"data-id":e.joinInfo.Attendee.AttendeeId,children:[Object(w.jsx)("svg",{className:"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_on",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M12 14C13.66 14 14.99 12.66 14.99 11L15 5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14ZM17.3 11C17.3 14 14.76 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C16.28 17.24 19 14.42 19 11H17.3Z",fill:"white"})}),Object(w.jsx)("svg",{className:"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_off",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z",fill:"white"})})]})]})]})},E=function(e){var t=Object(i.useState)(!0),n=Object(x.a)(t,2),c=n[0],a=n[1];Object(i.useEffect)((function(){e.muted||setTimeout((function(){a(!1)}),2e3)}),[]);var s=e.attendeeId,o=e.videoEnabled,r=e.name,u=e.muted,l=e.videoElement,d=s?"":" hidden",h=u?"controls__btn--mic_on":"controls__btn--mic_off",v=c||u||!o?"":" cam__meta--hide",b="video_".concat(s);return Object(w.jsxs)("div",{className:"cam".concat(d),onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},children:[Object(w.jsx)("div",{className:"cam__preview",children:Object(w.jsx)("div",{className:"video-container pos-relative",children:Object(w.jsx)("video",{ref:l,className:"attendee_cam remote-attendee",id:b})})}),Object(w.jsxs)("span",{className:"cam__meta".concat(v),children:[r,Object(w.jsxs)("span",{className:"".concat(h," btn--mic"),"data-id":s,children:[Object(w.jsx)("svg",{className:"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_on",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M12 14C13.66 14 14.99 12.66 14.99 11L15 5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14ZM17.3 11C17.3 14 14.76 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C16.28 17.24 19 14.42 19 11H17.3Z",fill:"white"})}),Object(w.jsx)("svg",{className:"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_off",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(w.jsx)("path",{d:"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z",fill:"white"})})]})]})]},s)},M=function(e){var t=e.chime,n=e.joinInfo,a=Object(i.useState)([]),s=Object(x.a)(a,2),o=s[0],r=s[1],u=Object(i.useState)({}),l=Object(x.a)(u,2),h=l[0],v=l[1],b=function(e){var t;for(t=0;t<o.length;t++)if(o[t].attendeeId===e)return t;for(t=0;t<o.length;t++)if(!o[t].attendeeId)return t;return 0},p=function(e){if(Object.keys(e).length,Object.keys(e).length<Object.keys(h).length){d;var t,i=Object.keys(h).filter((function(t){return h[t]!==e[t]}));if(i.length)for(t in i){var c=b(i[t]),a=o;a[c]={videoElement:a[c].videoElement},r(a)}}var s;for(s in v(Object.assign({},e)),e)if(s!==n.Attendee.AttendeeId&&e[s].name){var u=b(s),l=o,p=Object(_.a)(Object(_.a)({},l[u]),{},{attendeeId:s},e[s]);l[u]=p,r(l)}},m=function(e){if(e.boundAttendeeId&&!e.localTile&&!e.isContent&&e.tileId){var n=b(e.boundAttendeeId),i=o,c=Object(_.a)(Object(_.a)({},i[n]),{},{videoEnabled:e.active,attendeeId:e.boundAttendeeId,tileId:e.tileId});i[n]=c,r(i),setTimeout((function(){var n=document.getElementById("video_".concat(e.boundAttendeeId));n&&t.audioVideo.bindVideoElement(e.tileId,n)}),1e3)}},j=function(e){var t=o;t.find((function(n,i){n.tileId===e&&(t[i].videoEnabled=!1,r(t))}))};return Object(i.useEffect)((function(){var e=[];return Array.from(Array(16).keys()).map((function(t,n){e[n]={videoElement:c.a.createRef()}})),r(e),t.subscribeToRosterUpdate(p),t.audioVideo.addObserver({videoTileDidUpdate:m,videoTileWasRemoved:j}),function(){t.unsubscribeFromRosterUpdate(p)}}),[]),Object(w.jsx)(c.a.Fragment,{children:o.map((function(e,n){return Object(w.jsx)(E,{chime:t,attendeeId:e.attendeeId,videoEnabled:e.videoEnabled,name:e.name,muted:e.muted,videoElement:e.videoElement},n)}))})},A=(n(334),void 0),U=Object(r.f)((function(e){var t=e.chime,n=e.history,a=e.location,s=Object(i.useState)(null),o=Object(x.a)(s,2),r=o[0],u=o[1],l=Object(i.useState)(!1),d=Object(x.a)(l,2),v=d[0],b=d[1],p=Object(i.useState)(),f=Object(x.a)(p,2),O=f[0],g=f[1],y=Object(i.useState)(),I=Object(x.a)(y,2),D=I[0],E=I[1],U=Object(i.useState)(""),R=Object(x.a)(U,2),T=R[0],H=R[1],z=Object(i.useState)(""),P=Object(x.a)(z,2),B=P[0],Z=P[1],J=Object(i.useState)(""),F=Object(x.a)(J,2),W=F[0],K=F[1],Y=Object(i.useState)(""),q=Object(x.a)(Y,2),G=q[0],X=q[1],$=Object(i.useRef)(),Q=Object(i.useRef)();Object(i.useEffect)((function(){var e=function(){var e=Object(h.a)(m.a.mark((function e(){var i,c,s,o,r,l,d,v,b,p;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=new URLSearchParams(a.search),c=i.get("room"),s="chime[".concat(c,"]"),H(s),c&&sessionStorage.getItem(s)||n.push("".concat("","/")),o=JSON.parse(sessionStorage.getItem(s)),r=o.username,l=o.title,d=o.role,X(o),o.joinInfo){e.next=20;break}return e.next=13,t.createRoom(d,r,l,o.playbackURL);case 13:v=e.sent,b=Object(_.a)(Object(_.a)({},o),{},{joinInfo:v}),sessionStorage.setItem(s,JSON.stringify(b)),K(v),Z(v.PlaybackURL),e.next=25;break;case 20:return p=o.joinInfo,e.next=23,t.reInitializeMeetingSession(p,r);case 23:K(p),Z(o.joinInfo.PlaybackURL);case 25:return u("Success"),t.audioVideo.addObserver({audioVideoDidStop:function(){var e=Object(h.a)(m.a.mark((function e(i){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.statusCode()===j.MeetingSessionStatusCode.AudioCallEnded&&(c="".concat("","/").concat("host"===d?"":"end"),t.leaveRoom("host"===d),n.push(c));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),e.next=29,t.joinRoom($.current);case 29:e.next=37;break;case 31:e.prev=31,e.t0=e.catch(0),console.log("error",e.t0),g(!0),E(e.t0.message),u("Failed");case 37:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var ee=function(e){if(v){for(var t=e.target,n=!1;t;){if(t&&t.classList&&t.classList.contains("modal__el")){n=!0;break}t=t.parentNode}n||b(!0)}},te=function(e,n,i){t.chooseCurrentVideoInputDevice=i,t.chooseCurrentAudioinputDevice=e,t.chooseCurrentAudioOutputDevice=n,b(!1)};return Object(w.jsxs)(c.a.Fragment,{children:[Object(w.jsx)("audio",{ref:$,style:{display:"none"}}),function(){if("Success"===r)return Object(w.jsxs)("div",{className:"app-grid",onClick:ee,children:[Object(w.jsxs)("div",{className:"main-stage",children:[Object(w.jsxs)("div",{className:"cams pos-relative",children:[Object(w.jsx)(N,{chime:t,joinInfo:W}),Object(w.jsx)(M,{chime:t,joinInfo:W})]}),Object(w.jsx)(k,{setMetadataId:function(e){return A.metadataId=e},videoStream:B}),Object(w.jsx)(S,{chime:t,baseHref:"",ssName:T,title:G.title,openSettings:function(){return b(!0)},role:G.role,history:n,myVideoElement:Q.current})]}),Object(w.jsx)(L,{chime:t,title:G.title,username:G.username,joinInfo:W}),v&&Object(w.jsx)(V,{chime:t,joinInfo:W,saveSettings:te,closeSettings:function(){return b(!1)}})]})}(),O&&Object(w.jsx)(C,{closeError:function(){return g(!1)},errorMsg:D})]})})),R=Object(r.f)((function(){return Object(w.jsxs)("div",{className:"welcome form-grid",children:[Object(w.jsx)("div",{className:"welcome__intro",children:Object(w.jsxs)("div",{className:"intro__inner formatted-text",children:[Object(w.jsx)("h1",{children:"Amazon IVS with ChimeSDK"}),Object(w.jsx)("h3",{children:"Create or join rooms, and watch Amazon IVS streams with anyone."})]})}),Object(w.jsx)("div",{className:"welcome__content pd-4",children:Object(w.jsxs)("div",{className:"content__inner formatted-text",children:[Object(w.jsx)("h2",{className:"mg-b-2",children:"Room closed"}),Object(w.jsx)("p",{children:"The host has ended the meeting and closed the room."}),Object(w.jsx)("a",{href:"".concat("","/"),className:"mg-t-3 btn btn--primary",children:"Create a new room"})]})})]})}));var T=function(){var e=new g;return Object(w.jsx)("div",{className:"App full-width full-height",children:Object(w.jsx)(o.a,{children:Object(w.jsxs)(r.c,{children:[Object(w.jsx)(r.a,{path:"".concat("","/end"),children:Object(w.jsx)(R,{})}),Object(w.jsx)(r.a,{path:"".concat("","/meeting"),children:Object(w.jsx)(U,{chime:e})}),Object(w.jsx)(r.a,{path:"".concat("","/join"),children:Object(w.jsx)(I,{chime:e})}),Object(w.jsx)(r.a,{path:"".concat(""),children:Object(w.jsx)(y,{chime:e})})]})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(w.jsx)(c.a.StrictMode,{children:Object(w.jsx)(T,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[335,1,2]]]);
//# sourceMappingURL=main.9a36f76e.chunk.js.map